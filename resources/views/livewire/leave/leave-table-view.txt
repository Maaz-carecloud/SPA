<!-- <x-data-table 
                title="Leave Records"
                :headers="['#', 'Name & ID', 'Leave Type', 'Reason', 'From Date', 'To Date', 'Days', 'Attachment', 'Status', 'Modified By', 'Modified At', 'Actions']"
                :sortable-headers="['id', null, null, 'leave_reason', 'date_from', 'date_to', 'total_days', null, 'status', null, 'updated_at', null]"
                :items="$leaveRecords"
                table-id="leave-records-table"
                search-placeholder="Search by employee name, reason..."
                :show-export="true"
            >
                @forelse($leaveRecords as $leave)
                    <tr>
                        <td>{{ $loop->iteration + ($leaveRecords->currentPage() - 1) * $leaveRecords->perPage() }}</td>
                        <td>
                            <div class="d-flex align-items-center">
                                <div class="avatar-sm me-2">
                                    <div class="avatar-title bg-light text-primary rounded-circle">
                                        <i class="fas fa-user"></i>
                                    </div>
                                </div>
                                <div>
                                    <span class="badge bg-secondary text-white mb-1">
                                        <i class="fas fa-user me-1"></i>
                                        {{ $leave->user->user_type ?? 'N/A' }}
                                    </span>
                                    <h6 class="mb-0">{{ $leave->user->name ?? 'N/A' }}</h6>
                                    <small class="text-muted">ID: {{ $leave->user->id ?? '' }}</small>
                                </div>
                            </div>
                        </td>
                        <td>
                            @if($leave->leaveType?->name)
                                <span class="badge bg-info">{{ $leave->leaveType->name }}</span>
                            @else
                                <span class="text-muted">N/A</span>
                            @endif
                        </td>
                        <td>
                            <span class="text-truncate" style="max-width: 200px; display: inline-block;" title="{{ $leave->leave_reason }}">
                                {{ Str::limit($leave->leave_reason, 50) }}
                            </span>
                        </td>
                        <td>
                            <small>{{ $leave->date_from?->format('M d, Y') ?? '-' }}</small>
                        </td>
                        <td>
                            <small>{{ $leave->date_to?->format('M d, Y') ?? '-' }}</small>
                        </td>
                        <td>
                            <span class="badge bg-secondary">{{ $leave->total_days }} day(s)</span>
                        </td>
                        <td class="text-center">
                            @if ($leave->attachment)
                                <button wire:click="downloadAttachment({{ $leave->id }})"
                                    class="btn btn-sm btn-outline-primary" title="Download Attachment">
                                    <i class="fas fa-download"></i>
                                </button>
                            @else
                                <span class="text-muted">-</span>
                            @endif
                        </td>
                        <td class="text-center">
                            @if ($leave->status)
                                <span class="badge bg-success">
                                    <i class="fas fa-check me-1"></i>Approved
                                </span>
                            @else
                                <span class="badge bg-warning">
                                    <i class="fas fa-clock me-1"></i>Pending
                                </span>
                            @endif
                        </td>
                        <td>
                            @if ($leave->updated_by)
                                <div class="d-flex align-items-center">
                                    <div class="avatar-xs me-2">
                                        <div class="avatar-title bg-light text-secondary rounded-circle">
                                            <i class="fas fa-user-edit"></i>
                                        </div>
                                    </div>
                                    <div>
                                        <div class="fw-medium">{{ $leave->updated_by }}</div>
                                        <small class="text-muted">Modified By</small>
                                    </div>
                                </div>
                            @else
                                <span class="text-muted">N/A</span>
                            @endif
                        </td>
                        <td>
                            <small>{{ $leave->updated_at ? $leave->updated_at->format('M d, Y H:i') : 'N/A' }}</small>
                        </td>
                        <td>
                            <div class="btn-group" role="group">
                                {{-- View Button --}}
                                <a href="{{ route('leave.view', $leave->id) }}" wire:navigate
                                    class="btn btn-sm btn-info me-1" title="View Details">
                                    <i class="fas fa-eye"></i>
                                </a>

                                {{-- Edit Button - Only for creator or admin --}}
                                @php
                                    $isAdmin = method_exists(Auth::user(), 'hasRole')
                                        ? Auth::user()->hasRole('admin')
                                        : Auth::user()->user_type === 'admin';
                                @endphp
                                @if ($isAdmin || $leave->created_by === Auth::user()->name)
                                    <a href="{{ route('leave.edit', $leave->id) }}" wire:navigate
                                        class="btn btn-sm btn-warning me-1" title="Edit">
                                        <i class="fas fa-edit"></i>
                                    </a>
                                @endif

                                {{-- Status Toggle - Only for admin --}}
                                @if ($isAdmin)
                                    <button
                                        class="btn btn-sm btn-{{ $leave->status ? 'danger' : 'success' }} me-1"
                                        title="{{ $leave->status ? 'Reject' : 'Approve' }}"
                                        wire:click="toggleStatus({{ $leave->id }})"
                                        wire:confirm="Are you sure you want to {{ $leave->status ? 'reject' : 'approve' }} this leave?">
                                        <i class="fas fa-{{ $leave->status ? 'times' : 'check' }}"></i>
                                    </button>
                                @endif

                                {{-- Delete Button - Only for creator or admin --}}
                                @if ($isAdmin || $leave->created_by === Auth::user()->name)
                                    <button class="btn btn-sm btn-danger" title="Delete"
                                        wire:click="deleteLeave({{ $leave->id }})"
                                        wire:confirm="Are you sure you want to delete this leave record?">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                @endif
                            </div>
                        </td>
                    </tr>
                @empty
                    <tr>
                        <td colspan="12" class="text-center py-4">
                            <div class="text-muted">
                                <i class="fas fa-calendar-times fa-3x mb-3"></i>
                                <h5>No Leave Records Found</h5>
                                <p>No leave records match your current filters.</p>
                                <a href="{{ route('leave.create') }}" wire:navigate class="btn btn-primary">
                                    <i class="fas fa-plus me-1"></i>Create First Leave Request
                                </a>
                            </div>
                        </td>
                    </tr>
                @endforelse
            </x-data-table> -->